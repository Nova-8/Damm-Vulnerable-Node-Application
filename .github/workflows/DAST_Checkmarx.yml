name: Checkmarx DAST

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Checkmarx DAST Github Action
        uses: Checkmarx/dast-github-action@v1.0.0-beta
        with:
          CX_APIKEY: ${{ secrets.CX_ONE_API_KEY }}
          command: api
          config: zap_api_config.yaml
          base_url: localhost.cxast.net
          environment_id: c608a51a-ec4e-4eef-81c4-a0241737efd7
          openapi: swagger.yaml
          project_id: fd093dde-b64a-466f-b2cd-8bf141b4db94
          fail_on: HIGH
          verbose: true

      - name: Upload Logs
        uses: actions/upload-artifact@v3
        with:
          name: report
          path: ./output
